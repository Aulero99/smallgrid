@use "sass:map";
@use 'sass:list';
@import "../var/_variables.scss";
@import "../var/_variable-maps.scss";
@import "./_units.scss";

// This file contains the logic for the base grid of Suspendors
// that includes all the .container, .row, .col and .vol
// and all derivatives of those classes (-bp-x) as well as
// classes strictly necessary to define spacing in the
// flexbox made with the grid



// STUB - Container

%container-base{
    display: block;
    width: 100%;
    overflow-x: hidden;
    margin-left: auto;
    margin-right: auto;
}

%container-solid-base{
    max-width: $root-container-shift-width;
}

@if $grid-as-class {    
    .container{
        @extend %container-base;
        max-width: 100vw;
    }
      
    .container-solid, .container-shift{ 
        @extend %container-base; 
        max-width: #{map.get($container-solid-map, 'xxl')};
    }
   
    @each $break, $screen in $breakpoint-map-ref{
        .container-#{$break}{ 
            @extend %container-base;
            max-width: map.get($container-solid-map, $break);
        }
    }

    @each $break, $screen in reverse-breakpoints($breakpoint-map){
        .container-#{$break}-solid{
            @extend %container-solid-base;
            @extend %container-base;
        }
        .container-#{$break}-shift{
            @extend %container-base;
        }
        @media (min-width: $screen) {
            .container-#{$break}-solid{
                max-width: #{map.get($container-solid-map, $break)};
            }
            .container-solid, .container-shift{
                max-width: #{map.get($container-solid-map, $break)};
            }
            .container-#{$break}-shift{
                max-width: $root-container-shift-width;
            }
        }
    }
}

@if $grid-as-tag {

    #{$prefix}container{
        @extend %container-base;
        max-width: 100vw;

        @each $break, $screen in $breakpoint-map-ref{
            &[#{$break}]{
                max-width: map.get($container-solid-map, $break);
            }
        }
    }  

    #{$prefix}container-solid { 
        @extend %container-base; 
        width: $root-container-shift-width;
        max-width: #{map.get($container-solid-map, 'xxl')};

        @each $break, $screen in reverse-breakpoints($breakpoint-map){
            @media (min-width: $screen) {
                &[#{$break}]{
                    max-width: #{map.get($container-solid-map, $break)};
                }
            }
        }
    }

    #{$prefix}container-shift { 
        @extend %container-base; 
        width: 100%;
        max-width: #{map.get($container-solid-map, 'xxl')};
        
        @each $break, $screen in reverse-breakpoints($breakpoint-map){
            @media (min-width: $screen) {
                &[#{$break}]{
                    max-width: $root-container-shift-width;
                }
            }
        }
    }
}

@each $break, $screen in reverse-breakpoints($breakpoint-map){
    @media (min-width: $screen) {
        :root{
            --#{$prefix}container-shift-width: #{map.get($container-solid-map, $break)};
        }
    }
}

// STUB - Col

%col-extend {
    --width: 100%;
    width: var(--width);
    display: block;
}

@if $grid-as-class {    
    .col{
        @extend %col-extend;
    }
}

@if $grid-as-tag {        
    #{$prefix}col{
        @extend %col-extend;
    }
}

@if $grid-as-class {    
    @each $break, $screen in $breakpoint-map-ref{
        @each $name, $width in $col-map{
            .col-#{$break}-#{$name}{ 
                @extend %col-extend;
             }
        }
    }
}

@if $grid-as-class {
    @each $name, $width in $col-map{
        .col-#{$name}, .cols-#{$name} .col{
            --width: #{$width};
            width: var(--width); 
        }
    }
}

@if $grid-as-tag{
    @each $name, $width in $col-map{
        col-#{$name}, *[cols-#{$name}] >#{$prefix}col{
            display: block;
            --width: #{$width};
            width: var(--width); 
        }
    }
}

@if $grid-as-class {    
    @each $break, $screen in $breakpoint-map-ref{
        @media screen and (#{$minmax}: $screen){
            @each $name, $width in $col-map{
                .col-#{$break}-#{$name}, .cols-#{$break}-#{$name} .col{ 
                    --width: #{$width};
                    width: var(--width); 
                }
            }
        }
    }
}

@if $grid-as-tag{
    @each $break, $screen in $breakpoint-map-ref{
        @media screen and (#{$minmax}: $screen){
            col-1, col-2, col-3, col-4, col-5, col-6, col-7, col-8, col-9, col-10, col-11, col-12, #{$prefix}col{
                @each $name, $width in $col-map{
                    &[#{$break}-#{$name}]{ 
                        --width: #{$width};
                    }
                }
            }
            @each $name, $width in $col-map{
                *[cols-#{$break}-#{$name}] >#{$prefix}col{ 
                    --width: #{$width};
                }
            }
        }
    }
}

@if $grid-as-class {
    .col-fill{
        width: 0;
        flex-grow: 1;
    }
    @each $break, $screen in $breakpoint-map-ref{
        @media screen and (#{$minmax}: $screen){
            @each $name, $width in $col-map{
                .col-#{$break}-fill{ 
                    width: 0;
                    flex-grow: 1;
                }
            }
        }
    }
}

@if $grid-as-tag {
    col-fill{
        width: 0;
        flex-grow: 1;
    }
    @each $break, $screen in $breakpoint-map-ref{
        @media screen and (#{$minmax}: $screen){
            col-1, col-2, col-3, col-4, col-5, col-6, col-7, col-8, col-9, col-10, col-11, col-12, #{$prefix}col{
                @each $name, $width in $col-map{
                    &[col-#{$break}-fill]{ 
                        width: 0;
                        flex-grow: 1;
                    }
                }
            }
        }
    }
}

// STUB - Row

@if $grid-as-class{
    .row{
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        &.flex-col{ flex-direction: column;}
    }
}

@if $grid-as-tag{
    #{$prefix}row{
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        &[flex-col]{ flex-direction: column;}
    }
}
    

// STUB - Vol
// NOTE
// because of how useful volume is outside of the grid, I made it so that it can be used
// both as a parameter, a data-vol custom parameter as well as a class

@each $key, $value in $vol-map { 
    *[vol-#{$key}], *[data-vol-#{$key}], .vol-#{$key} { 
        height: $value;
    }
}
 
// Breakpoints
@each $break, $screen in $breakpoint-map-ref {
    @media (#{$minmax}: $screen){
        @each $k2, $v2 in $vol-map { 
            *[vol-#{$break}-#{$k2}], *[data-vol-#{$break}-#{$k2}], .vol-#{$break}-#{$k2} { 
                height: $v2;
            }
        }
    }
}
